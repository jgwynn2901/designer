<HTML>
<HEAD>
<TITLE>ATL 3.0 test page for object LayoutCtl!</TITLE>
</HEAD>
<BODY>
<INPUT TYPE=button ID=PBUTTON VALUE="Set Control New Properties">
<INPUT TYPE=button ID=RBUTTON VALUE="Get Control Result"><BR>
<INPUT TYPE=button ID=COLBUTTON VALUE="Create Page Items"><BR>
<INPUT TYPE=button ID=COLDATABUTTON VALUE="Show Page Items data">
<INPUT TYPE=button ID=ZOOMINBUTTON VALUE="Zoom In">
<INPUT TYPE=button ID=ZOOMOUTBUTTON VALUE="Zoom Out"><BR>
<INPUT TYPE=button ID=SHOWSELECTEDBUTTON VALUE="Show Selected Item Data">
<INPUT TYPE=button ID=DELALLBUTTON VALUE="Delete All">
<BR>
<INPUT TYPE=button ID=MODIFYSELBUTTON VALUE="Modify Selected"><BR>
<INPUT TYPE=button ID=SEL1BUTTON VALUE="Select RefID1"><BR>
<INPUT TYPE=button ID=DEL1BUTTON VALUE="Delete RefID1"><BR>
<INPUT TYPE=button ID=READ1BUTTON VALUE="Set ReadOnly"><BR>
<INPUT TYPE=button ID=SETMENU VALUE="Set Menu">
<INPUT TYPE=button ID=SELECTEDONLY VALUE="Show Selected (on/off)"><BR>
<INPUT TYPE=button ID=UNDOITEMDATA VALUE="Get Undo Item data">
<INPUT TYPE=button ID=UNDOITEM VALUE="Do Undo"><BR>
<OBJECT classid=CLSID:13A2FD71-9ECC-11D2-AF73-0060082408D7  
id=LayoutCtl style="BACKGROUND-COLOR: #C3C3C3" width=883 height=533>
	<PARAM NAME="DefaultLabel" VALUE="Def. Label">
	<PARAM NAME="DefaultSampleValue" VALUE="X">
	<PARAM NAME="DefaultAttributeKey" VALUE="Caller:Name:LastName">
	<PARAM NAME="DefaultItemType" VALUE="Output Field">
	<PARAM NAME="DefaultFontName" VALUE="Arial">
	<PARAM NAME="DefaultFontPointSize" VALUE="8">
	<PARAM NAME="DefaultXPos" VALUE="1">
	<PARAM NAME="DefaultYPos" VALUE="1">
	<PARAM NAME="DefaultWidth" VALUE="32">
	<PARAM NAME="DefaultHeight" VALUE="4">
	<PARAM NAME="DefaultBorderColor" VALUE="16777215">
	<PARAM NAME="DefaultSelectedBorderColor" VALUE="65535">
	<PARAM NAME="AutoCreateItem" VALUE="1">
	<PARAM NAME="XLogicalExtent" VALUE="100">
	<PARAM NAME="YLogicalExtent" VALUE="100">
	<PARAM NAME="ZoomIn" VALUE="0">
	<PARAM NAME="XViewExtent" VALUE="883">
	<PARAM NAME="YViewExtent" VALUE="533">
	<PARAM NAME="DefaultFormatString" VALUE="Testing FormatString">
	<PARAM NAME="DefaultMultiLine" VALUE="0">
	<PARAM NAME="DefaultStrikeout" VALUE="0">
	<PARAM NAME="DefaultUnderline" VALUE="0">
	<PARAM NAME="DefaultItalic" VALUE="0">
	<PARAM NAME="DefaultBold" VALUE="0">
	<PARAM NAME="MinWidth" VALUE="1">
	<PARAM NAME="MinHeight" VALUE="1">
	<PARAM NAME="XSelectedSensitivity" VALUE="1">
	<PARAM NAME="YSelectedSensitivity" VALUE="1">
	<PARAM NAME="ShowLabel" VALUE="TRUE">
	<PARAM NAME="DefaultMandatoryFlag" VALUE="FALSE">
	<PARAM NAME="DefaultSampleValue" VALUE="X">
	<PARAM NAME="DefaultLabelOffsetX" VALUE="0">
	<PARAM NAME="DefaultLabelOffsetY" VALUE="-3">
	<PARAM NAME="ShowAttribute" VALUE="TRUE">
	<PARAM NAME="ShowSampleValue" VALUE="FALSE">
	<PARAM NAME="ShowLabel" VALUE="TRUE">
	<PARAM NAME="DefaultBorderThickness" VALUE="0">
	<PARAM NAME="DefaultItemBackColor" VALUE="39372">
	<PARAM NAME="BoldLabelOnMandatory" VALUE="TRUE">
	<PARAM NAME="DefaultItemBackColorSelected" VALUE="65535">
	<PARAM NAME="DefaultItemTextColor" VALUE="39219">
	<PARAM NAME="UseTransparentItemBackground" VALUE="FALSE">
	<PARAM NAME="UseAnisotropicMapMode" VALUE="TRUE">
	<PARAM NAME="ShowGridBorder" VALUE="TRUE">
	<PARAM NAME="DefaultMandatoryBackColor" VALUE="255">
	<PARAM NAME="GridBorderX" VALUE="0">
	<PARAM NAME="GridBorderY" VALUE="0">
	<PARAM NAME="GridBorderWidth" VALUE="91">
	<PARAM NAME="GridBorderHeight" VALUE="54">
		
</OBJECT>
<BR>
<DIV ID=RESULT>
</DIV>
</BODY>
</HTML>

<script LANGUAGE="VBSCRIPT">

Sub RBUTTON_onClick()
	Dim sResult
	sResult = ""

	sResult = sResult & "ZoomIn=" & LayoutCtl.ZoomIn & "<br>"
	sResult = sResult & "XLogicalExtent=" & LayoutCtl.XLogicalExtent & "<br>"
	sResult = sResult & "YLogicalExtent=" & LayoutCtl.YLogicalExtent & "<br>"
	sResult = sResult & "AutoCreateItem=" & LayoutCtl.AutoCreateItem & "<br>"
	sResult = sResult & "DefaultHeight=" & LayoutCtl.DefaultHeight & "<br>"
	sResult = sResult & "DefaultWidth=" & LayoutCtl.DefaultWidth & "<br>"
	sResult = sResult & "DefaultYPos=" & LayoutCtl.DefaultYPos & "<br>"
	sResult = sResult & "DefaultXPos=" & LayoutCtl.DefaultXPos & "<br>"
	sResult = sResult & "DefaultFontPointSize=" & LayoutCtl.DefaultFontPointSize & "<br>"
	sResult = sResult & "DefaultFontName=" & LayoutCtl.DefaultFontName & "<br>"

	sResult = sResult & "DefaultFormatString=" & LayoutCtl.DefaultFormatString & "<br>"
	sResult = sResult & "DefaultMultiLine=" & LayoutCtl.DefaultMultiLine & "<br>"
	sResult = sResult & "DefaultStrikeout=" & LayoutCtl.DefaultStrikeout & "<br>"
	sResult = sResult & "DefaultUnderline=" & LayoutCtl.DefaultUnderline & "<br>"
	sResult = sResult & "DefaultItalic=" & LayoutCtl.DefaultItalic & "<br>"
	sResult = sResult & "DefaultBold=" & LayoutCtl.DefaultBold & "<br>"

	sResult = sResult & "DefaultItemType=" & LayoutCtl.DefaultItemType & "<br>"
	sResult = sResult & "DefaultAttributeKey=" & LayoutCtl.DefaultAttributeKey & "<br>"
	sResult = sResult & "DefaultLabel=" & LayoutCtl.DefaultLabel & "<br>"
	sResult = sResult & "BackImageURL=" & LayoutCtl.BackImageURL & "<br>"
	sResult = sResult & "BackImageFilePath=" & LayoutCtl.BackImageFilePath & "<br>"
	sResult = sResult & "NextSequenceNumber=" & LayoutCtl.NextSequenceNumber & "<br>"
	RESULT.innerHTML = sResult
End Sub

Sub PBUTTON_onClick()
	LayoutCtl.ZoomIn = True
	LayoutCtl.YLogicalExtent = 300
	LayoutCtl.YLogicalExtent = 300
	LayoutCtl.AutoCreateItem = True
	LayoutCtl.DefaultHeight = 20
	LayoutCtl.DefaultWidth = 300
	LayoutCtl.DefaultYPos = 8
	LayoutCtl.DefaultXPos  = 5
	LayoutCtl.DefaultFontPointSize = "12"
	LayoutCtl.DefaultFontName = "Arial"
	LayoutCtl.DefaultItemType = "Temp type"
	LayoutCtl.DefaultAttributeKey = "temp attr"
	LayoutCtl.DefaultLabel = "Temp Label"
	LayoutCtl.BackImageURL = "http://Test/test.bmp"
	LayoutCtl.BackImageFilePath = "x:\temp.bmp"
	LayoutCtl.NextSequenceNumber = 5
End Sub



Sub LayoutCtl_OnItemRightClick(px, py, x, y, att, id)
	'MsgBox "OnItemRightClick : " & " px=" & px &  " py=" & py &  " x=" & x &  " y=" & y &  " att=" & att &  " id=" & id
End Sub


sub COLBUTTON_onClick()
	Dim NewObj
	Dim objCol
	Set objCol = LayoutCtl.PageItems

	'Define a template Item
	Set NewObj = objCol.AddBlankItemTemplate("SpecialField")
		
	NewObj.LabelOffsetY = -3
	NewObj.LabelOffsetX = -2
	NewObj.ItemBackColorSelected = 10053171
	NewObj.ItemBackColor = 16711935
	NewObj.FontName = "Times New Roman"
	NewObj.FontPointSize = 12
	NewObj.ItemTextColor = 0


	For i=0 To 2
		Set NewObj = objCol.AddItem ("refID"&i, "attrKey"&i, "Sample"&i, 3+(i*3), 3+(i*3), 8, 3, "Arial", 8, False, False, False, False, False, i, "Field", "MODIFY", "Format String"&i, False)
		NewObj.MandatoryFlag = True
	Next


	For i=3 To 5
		Set NewObj = objCol.AddBlankItem("refID"&i, "SpecialField")
		
		NewObj.Label = "Special label"&i
		NewObj.AttributeKey = "Special Attr"&i
		NewObj.XPos = i*6
		NewObj.YPos = i*6
		NewObj.SetExtraProperty "TESTATTR1", True, 44
		NewObj.SetExtraProperty "TESTATTR1", True, i*2
		NewObj.SetExtraProperty "TESTATTR2", True, "ABC"

	Next




	'LayoutCtl.ShowLabel = True
	'LayoutCtl.ShowAttribute = True
	'LayoutCtl.ShowSampleValue = False

	LayoutCtl.CleanAllDirty
	LayoutCtl.RedrawItems

End Sub


sub COLDATABUTTON_onClick()
	
	Dim objCol
	Set objCol = LayoutCtl.PageItems

	Dim sResult
	sResult = ""

	For Each x In objCol
		sResult = sResult & "Status="		& x.Status & "<br>"
		sResult = sResult & "Dirty="		& x.Dirty & "<br>"
		sResult = sResult & "AttributeKey=" & x.AttributeKey & "<br>"
		sResult = sResult & "Label="		& x.Label & "<br>"
		sResult = sResult & "XPos="			& x.XPos & "<br>"
		sResult = sResult & "YPos="			& x.YPos & "<br>"
		sResult = sResult & "Width="		& x.Width & "<br>"
		sResult = sResult & "Height="		& x.Height & "<br>"		
		sResult = sResult & "FontName="		& x.FontName & "<br>"

		sResult = sResult & "Bold="			& x.Bold & "<br>"
		sResult = sResult & "Italic="		& x.Italic & "<br>"
		sResult = sResult & "Underline="	& x.Underline & "<br>"
		sResult = sResult & "Strikeout="	& x.Strikeout & "<br>"
		sResult = sResult & "MultiLine="	& x.MultiLine & "<br>"
		sResult = sResult & "FormatString="	& x.FormatString & "<br>"


		sResult = sResult & "FontPointSize="& x.FontPointSize & "<br>"
		sResult = sResult & "RefID="		& x.RefID & "<br>"
		sResult = sResult & "ReadOnly="		& x.ReadOnly & "<br>"		
		sResult = sResult & "Sequence="		& x.Sequence & "<br>"
		sResult = sResult & "ItemType="		& x.ItemType & "<br>"

		sResult = sResult & "ExtraProperty:TESTATTR="& x.GetExtraProperty("TESTATTR1") & "<br>"
		sResult = sResult & "ExtraProperty:TESTATTR2="& x.GetExtraProperty("TESTATTR2") & "<br>"
		sResult = sResult & "ExtraProperty:TESTATTR3="& x.GetExtraProperty("TESTATTR3") & "<br>"

		sResult = sResult & "<BR><BR>"
	Next
	
	RESULT.innerHTML = sResult

End Sub



Sub ZOOMINBUTTON_onclick
		LayoutCtl.ZoomIn = True
		LayoutCtl.width = LayoutCtl.XViewExtent * 2
		LayoutCtl.height = LayoutCtl.YViewExtent * 2
End Sub

Sub ZOOMOUTBUTTON_onclick
		LayoutCtl.ZoomIn = False
		LayoutCtl.width = LayoutCtl.XViewExtent
		LayoutCtl.height = LayoutCtl.YViewExtent
End Sub

Sub SHOWSELECTEDBUTTON_onClick()
	Dim x
	Dim sResult

	Set x = LayoutCtl.GetSelectedItem

	If IsObject(x) Then
		
		sResult = ""
		sResult = sResult & "Status="		& x.Status & "<br>"
		sResult = sResult & "Dirty="		& x.Dirty & "<br>"
		sResult = sResult & "AttributeKey=" & x.AttributeKey & "<br>"
		sResult = sResult & "Label="		& x.Label & "<br>"
		sResult = sResult & "XPos="			& x.XPos & "<br>"
		sResult = sResult & "YPos="			& x.YPos & "<br>"
		sResult = sResult & "Width="		& x.Width & "<br>"
		sResult = sResult & "Height="		& x.Height & "<br>"		
		sResult = sResult & "FontName="		& x.FontName & "<br>"
		sResult = sResult & "FontPointSize="& x.FontPointSize & "<br>"
		sResult = sResult & "Bold="			& x.Bold & "<br>"
		sResult = sResult & "Italic="		& x.Italic & "<br>"
		sResult = sResult & "Underline="	& x.Underline & "<br>"
		sResult = sResult & "Strikeout="	& x.Strikeout & "<br>"
		sResult = sResult & "MultiLine="	& x.MultiLine & "<br>"
		sResult = sResult & "FormatString="	& x.FormatString & "<br>"
		sResult = sResult & "RefID="		& x.RefID & "<br>"
		sResult = sResult & "ReadOnly="		& x.ReadOnly & "<br>"		
		sResult = sResult & "Sequence="		& x.Sequence & "<br>"
		sResult = sResult & "ItemType="		& x.ItemType & "<br>"

		sResult = sResult & "XPixPos="		& LayoutCtl.GetXPixelPos(x.XPos) & "<br>"
		sResult = sResult & "YPixPos="		& LayoutCtl.GetYPixelPos(x.YPos) & "<br>"

		sResult = sResult & "<BR><BR>"

		RESULT.innerHTML = sResult
	Else
		RESULT.innerHTML = "No Object Selected"
	End If

End Sub

Sub DELALLBUTTON_onClick()
	Dim objCol
	Set objCol = LayoutCtl.PageItems

	Dim sResult
	sResult = ""

	For Each x In objCol
		x.Deleted = TRUE
	Next
	RESULT.innerHTML = sResult

End Sub

Sub MODIFYSELBUTTON_onClick()
	Dim x
	Set x = LayoutCtl.GetSelectedItem

	x.UpdateGroupBegin
	x.Bold = TRUE
	x.FormatString = "New Format String"
	x.SetExtraProperty "TESTATTR1", True, 888
	x.SetExtraProperty "TESTATTR2", True, "New Attr2"
	x.SetExtraProperty "TESTATTR3", True, "New Attr3"
	x.YPos = 0
	x.UpdateGroupEnd

	LayoutCtl.RedrawItems

End Sub

Sub SEL1BUTTON_onClick()
	LayoutCtl.SetSelectedItem("refID1")
End Sub

Sub DEL1BUTTON_onClick()
	LayoutCtl.DeleteItem("refID1")	
End Sub

Sub READ1BUTTON_onClick()
	Dim obj
	Set obj = LayoutCtl.GetSelectedItem

	If IsObject(obj) Then
		obj.ReadOnly = True
	End If
End Sub

Sub SETMENU_onClick()
	LayoutCtl.SetContextMenu "DEFAULT", "COMMAND|Zoom|100|COMMAND|Options...|101", "|"
	LayoutCtl.SetContextMenu "FIELD", "SEPARATOR|0|1|COMMAND|Remove|400|COMMAND|Properties...|401|SEPARATOR|0|2|COMMAND|Remove|402", "|"
End Sub


Sub LayoutCtl_OnMenuCommand(id)
	MsgBox "Menu Command ID=" & id
End Sub

Dim SelectedOn
SelectedOn = False

Sub SELECTEDONLY_onclick()
	SelectedOn = Not SelectedOn
	LayoutCtl.ShowSelectedOnly = SelectedOn
End Sub


Sub UNDOITEM_onClick()
	LayoutCtl.Undo
End Sub


Sub UNDOITEMDATA_onClick()
	Dim x
	Dim sResult
	Dim obj

	Set obj = LayoutCtl.GetSelectedItem

	If Not IsObject(obj) Then
		Exit Sub
	End If
	Set x = obj.GetUndoItem

	If IsObject(x) Then
		
		sResult = ""
		sResult = sResult & "Status="		& x.Status & "<br>"
		sResult = sResult & "Dirty="		& x.Dirty & "<br>"
		sResult = sResult & "AttributeKey=" & x.AttributeKey & "<br>"
		sResult = sResult & "Label="		& x.Label & "<br>"
		sResult = sResult & "XPos="			& x.XPos & "<br>"
		sResult = sResult & "YPos="			& x.YPos & "<br>"
		sResult = sResult & "Width="		& x.Width & "<br>"
		sResult = sResult & "Height="		& x.Height & "<br>"		
		sResult = sResult & "FontName="		& x.FontName & "<br>"
		sResult = sResult & "FontPointSize="& x.FontPointSize & "<br>"
		sResult = sResult & "Bold="			& x.Bold & "<br>"
		sResult = sResult & "Italic="		& x.Italic & "<br>"
		sResult = sResult & "Underline="	& x.Underline & "<br>"
		sResult = sResult & "Strikeout="	& x.Strikeout & "<br>"
		sResult = sResult & "MultiLine="	& x.MultiLine & "<br>"
		sResult = sResult & "FormatString="	& x.FormatString & "<br>"
		sResult = sResult & "RefID="		& x.RefID & "<br>"
		sResult = sResult & "ReadOnly="		& x.ReadOnly & "<br>"		
		sResult = sResult & "Sequence="		& x.Sequence & "<br>"
		sResult = sResult & "ItemType="		& x.ItemType & "<br>"

		sResult = sResult & "XPixPos="		& LayoutCtl.GetXPixelPos(x.XPos) & "<br>"
		sResult = sResult & "YPixPos="		& LayoutCtl.GetYPixelPos(x.YPos) & "<br>"

		sResult = sResult & "<BR><BR>"

		RESULT.innerHTML = sResult
	Else
		RESULT.innerHTML = "No Object Selected"
	End If

End Sub

Sub window_onLoad
	COLBUTTON_onClick
	LayoutCtl.EnableTrackUndo = TRUE
End Sub
</script>